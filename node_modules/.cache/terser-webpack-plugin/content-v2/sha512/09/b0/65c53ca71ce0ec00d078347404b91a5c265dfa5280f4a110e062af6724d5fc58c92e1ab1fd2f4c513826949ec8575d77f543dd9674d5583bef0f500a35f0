{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"fanwenqiang.vue-json-excel\"],{\"1bdd\":function(e,t,r){\"use strict\";r(\"6aa2\"),r(\"ac4d\"),r(\"8a81\"),r(\"28a5\");var n,a,i=r(\"7618\"),s=(r(\"4917\"),r(\"ac6a\"),r(\"456d\"),r(\"7f7f\"),r(\"a481\"),r(\"96cf\"),r(\"3b8d\")),o=r(\"aeb1\"),u=r.n(o),c=(String,Array,Object,Object,String,String,Function,Array,String,Function,Function,a=Object(s.a)(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(\"function\"!=typeof this.beforeGenerate){e.next=3;break}return e.next=3,this.beforeGenerate();case 3:if(t=this.data,\"function\"!=typeof this.fetch&&t){e.next=8;break}return e.next=7,this.fetch();case 7:t=e.sent;case 8:if(t&&t.length){e.next=10;break}return e.abrupt(\"return\");case 10:if(r=this.getProcessedJson(t,this.downloadFields),\"html\"!==this.type){e.next=15;break}return e.abrupt(\"return\",this.export(this.jsonToXLS(r),this.name.replace(\".xls\",\".html\"),\"text/html\"));case 15:if(\"csv\"!==this.type){e.next=17;break}return e.abrupt(\"return\",this.export(this.jsonToCSV(r),this.name.replace(\".xls\",\".csv\"),\"application/csv\"));case 17:return e.abrupt(\"return\",this.export(this.jsonToXLS(r),this.name,\"application/vnd.ms-excel\"));case 18:case\"end\":return e.stop()}},e,this)})),n=Object(s.a)(regeneratorRuntime.mark(function e(t,r,n){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.base64ToBlob(t,n),\"function\"!=typeof this.beforeFinish){e.next=4;break}return e.next=4,this.beforeFinish();case 4:u()(a,r,n);case 5:case\"end\":return e.stop()}},e,this)})),{props:{type:{type:String,default:\"xls\"},data:{type:Array,required:!1,default:null},fields:{type:Object,required:!1},exportFields:{type:Object,required:!1},defaultValue:{type:String,required:!1,default:\"\"},title:{default:null},footer:{default:null},name:{type:String,default:\"data.xls\"},fetch:{type:Function},meta:{type:Array,default:function(){return[]}},worksheet:{type:String,default:\"Sheet1\"},beforeGenerate:{type:Function},beforeFinish:{type:Function}},computed:{idName:function(){return\"export_\"+(new Date).getTime()},downloadFields:function(){return void 0!==this.fields?this.fields:void 0!==this.exportFields?this.exportFields:void 0}},methods:{generate:function(){var e=Object(s.a)(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(\"function\"!=typeof this.beforeGenerate){e.next=3;break}return e.next=3,this.beforeGenerate();case 3:if(t=this.data,\"function\"!=typeof this.fetch&&t){e.next=8;break}return e.next=7,this.fetch();case 7:t=e.sent;case 8:if(t&&t.length){e.next=10;break}return e.abrupt(\"return\");case 10:if(r=this.getProcessedJson(t,this.downloadFields),\"html\"!==this.type){e.next=15;break}return e.abrupt(\"return\",this.export(this.jsonToXLS(r),this.name.replace(\".xls\",\".html\"),\"text/html\"));case 15:if(\"csv\"!==this.type){e.next=17;break}return e.abrupt(\"return\",this.export(this.jsonToCSV(r),this.name.replace(\".xls\",\".csv\"),\"application/csv\"));case 17:return e.abrupt(\"return\",this.export(this.jsonToXLS(r),this.name,\"application/vnd.ms-excel\"));case 18:case\"end\":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),export:function(){var e=Object(s.a)(regeneratorRuntime.mark(function e(t,r,n){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.base64ToBlob(t,n),\"function\"!=typeof this.beforeFinish){e.next=4;break}return e.next=4,this.beforeFinish();case 4:u()(a,r,n);case 5:case\"end\":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),jsonToXLS:function(e){var t=\"<thead>\",r=Object.keys(e[0]).length,n=this;for(var a in null!=this.title&&(t+=this.parseExtraData(this.title,'<tr><th colspan=\"'+r+'\">${data}</th></tr>')),t+=\"<tr>\",e[0])t+=\"<th>\"+a+\"</th>\";return t+=\"</tr>\",t+=\"</thead>\",t+=\"<tbody>\",e.map(function(e,r){for(var a in t+=\"<tr>\",e)t+=\"<td>\"+n.valueReformattedForMultilines(e[a])+\"</td>\";t+=\"</tr>\"}),t+=\"</tbody>\",null!=this.footer&&(t+=\"<tfoot>\",t+=this.parseExtraData(this.footer,'<tr><td colspan=\"'+r+'\">${data}</td></tr>'),t+=\"</tfoot>\"),'<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content=\"Microsoft Excel 11\"><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>'.replace(\"${table}\",t).replace(\"${worksheet}\",this.worksheet)},jsonToCSV:function(e){var t=[];for(var r in null!=this.title&&t.push(this.parseExtraData(this.title,\"${data}\\r\\n\")),e[0])t.push(r),t.push(\",\");return t.pop(),t.push(\"\\r\\n\"),e.map(function(e){for(var r in e){var n='=\"'+e[r]+'\"';n.match(/[,\"\\n]/)&&(n='\"'+n.replace(/\\\"/g,'\"\"')+'\"'),t.push(n),t.push(\",\")}t.pop(),t.push(\"\\r\\n\")}),null!=this.footer&&t.push(this.parseExtraData(this.footer,\"${data}\\r\\n\")),t.join(\"\")},getProcessedJson:function(e,t){var r=this.getKeys(e,t),n=[],a=this;return e.map(function(e,t){var i={};for(var s in r){var o=r[s];i[s]=a.getValue(o,e)}n.push(i)}),n},getKeys:function(e,t){if(t)return t;var r={};for(var n in e[0])r[n]=n;return r},parseExtraData:function(e,t){var r=\"\";if(Array.isArray(e))for(var n=0;n<e.length;n++)r+=t.replace(\"${data}\",e[n]);else r+=t.replace(\"${data}\",e);return r},getValue:function(e,t){var r=\"object\"!==Object(i.a)(e)?e:e.field,n=\"string\"!=typeof r?[]:r.split(\".\"),a=this.defaultValue;return a=r?n.length>1?this.getValueFromNestedItem(t,n):this.parseValue(t[r]):t,e.hasOwnProperty(\"callback\")&&(a=this.getValueFromCallback(a,e.callback)),a},valueReformattedForMultilines:function(e){return\"string\"==typeof e?e.replace(/\\n/gi,\"<br/>\"):e},getValueFromNestedItem:function(e,t){var r=e,n=!0,a=!1,i=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value;r&&(r=r[u])}}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return this.parseValue(r)},getValueFromCallback:function(e,t){if(\"function\"!=typeof t)return this.defaultValue;var r=t(e);return this.parseValue(r)},parseValue:function(e){return e||0===e||\"boolean\"==typeof e?e:this.defaultValue},base64ToBlob:function(e,t){for(var r=window.btoa(window.unescape(encodeURIComponent(e))),n=atob(r),a=n.length,i=new Uint8ClampedArray(a);a--;)i[a]=n.charCodeAt(a);return new Blob([i],{type:t})}}}),l=r(\"2455\"),h=Object(l.a)(c,function(){var e=this.$createElement;return(this._self._c||e)(\"div\",{attrs:{id:this.idName},on:{click:this.generate}},[this._t(\"default\",[this._v(\"\\n\\t\\tDownload \"+this._s(this.name)+\"\\n\\t\")])],2)},[],!1,null,null,null);t.a=h.exports}}]);","extractedComments":[]}